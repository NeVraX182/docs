= AsciiDoc & doc-as-code Best Practices
include::subdocs/_init.adoc[]

ifndef::imagesdir[:imagesdir: images]

image::geek-and-poke-look-like-perl.jpg[{half-width}]

== Editor

To help you to write your documentation, use AsciidocFX. It will allows you to visualize your documentation without having to generate the PDF. You can consider Visual Studio Code too, it has a nice plugin but with less features.

image::AsciidocFX.png[{full-width}]

Download and install :

* AsciidocFX, to create and edit your documents
* Graphviz, to add the extension for your AsciidocFX installation

.Rules to produce AsciiDoc files :
* File names are in kebab-case, except the type at the beginning
* Use *\kbd:[myShortcut]* for keyboard shortcuts
* Use *\btn[myButton]* for buttons
* High level title should be on new pages (use *<<<*)
* Don't forget init/closure includes at beginning/end of the adoc
* For STS, use TMP-STS-webmethods-template.adoc as a template

To show a in progress diagram to colleagues, you can generate a web link using link:http://www.plantuml.com/plantuml/uml/[PlantUml generator].

== Inline icons

* See https://asciidoctor.org/docs/user-manual/#icons
* Font Awesome 4.6.3 Class Explorer :  https://lab.artlung.com/font-awesome-sample/
** no need for :icons: font to use font awesome-font for icons

== Custom highlighter

* See the maven configuration below, it speaks for itself
* Highlight.js demo with all languages and all styles
* Default highlight.js processor is too basic, instructions here to change : https://asciidoctor.org/docs/user-manual/#highlight-js

image::geek-and-poke-whole-documentation.jpg[{half-width}]

== Generation using Maven

You will find a sample Maven project generating both PDF and HTML, with current doc's layout, on link:https://github.com/bcouetil/asciidoctor-maven-sample[my Github].

ifdef::notdef[]
//Sadly, this is only available in AsciidocFX for now. So use the editor to produce the image, then import it as-is in your document.
[tree,file="tree-asciidoctor-maven-sample.png"]
----
cg-asciidoctor-sample
|--pom.xml
|--src
   |--docs
   |  `--asciidoc
   |     |--asciidoc-syntax-reference.adoc
   |     |--images
   |     |  |--pause.png
   |     |  |--play.png
   |     |  `--sunset.jpg
   |     |--themes
   |     |  |--cg-theme.yml
   |     |  |--favicon.png
   |     |  `--logo-pdf.png
   |     `--_includes
   |        |--attrs-charref.adoc
   |        |--attrs-env.adoc
   |        |--ex-table-data.adoc
   |        `--ex-table.adoc
   `--scripts
      `--asciidocHistory.sh
----
endif::notdef[]

.File system tree
image::tree-asciidoctor-maven-sample.png[{tier-width}]

.AsciiDoctor maven plugin configuration
[source,xml]
------
include::../../../pom.xml[tags=asciidoc-plugin,indent=0]
------

To generate the PDF locally, use the maven command :

[source, bash]
 mvn generate-resources --non-recursive

== .doc to .adoc

If the initial documentation is of Microsoft Word, you have to first migrate it to AsciiDoc file.

Download and install pandoc.

To migrate a document, use it in command line

[source, bash]
 pandoc --from=docx --to=asciidoc --wrap=none --atx-headers --normalize --extract-media=images monDoc.docx > monDoc.adoc

image::geek-and-poke-audit-coming.jpg[{half-width}]

== Publish HTML & PDF to github

=== Initialize Github space

[source, bash]
  mkdir docs
  cd docs
  git init
  git checkout --orphan gh-pages
  
Copy a first version of the site in the directory, then :

[source, bash]
  git add *
  git commit -m "initial site content"
  git remote add origin "https://github.com/NeVraX182/docs.git"
  git push --set-upstream origin gh-pages

image::geek-and-poke-lorem-ipsum.jpg[{half-width}]

=== Configure Maven plugin

.Maven SCM plugin configuration
[source,xml]
------
<plugin>
	<groupId>org.apache.maven.plugins</groupId>
	<artifactId>maven-scm-publish-plugin</artifactId>
	<version>3.0.0</version>
	<inherited>false</inherited>
	<configuration>
		<scmBranch>gh-pages</scmBranch>
		<!-- token generated from github > settings > Developer settings > Personal access tokens > public_repo -->
		<pubScmUrl>scm:git:https://USER:TOKEN@github.com/USER/docs.git</pubScmUrl>
		<content>target/generated-docs</content>
	</configuration>
</plugin>
------

== Use in pipelines

To use in Jenkins Pipelines, see link:BP-jenkins.html[Jenkins Best Practices]

To use in Gitlab Pipelines, see link:BP-gitlab.html[Gitlab Best Practices]

image::geek-and-poke-huge-enough.jpg[{half-width}]

include::subdocs/_closure.adoc[]
